<!DOCTYPE html>
<html>
<head>
    <title>Kiosk Schema - Dag 0</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <link rel="stylesheet" href="lista_style.css"> 
</head>

<body>
    <div id="splash"></div>
    <div id="clock">--:----</div>
    <div id="lastUpdate">Last update: --:--</div>
    <div id="leftStripe"></div>
    
    <div id="nav-container"></div>
    <div id="tab-mask"></div> 

    <iframe id="sheetFrame" src=""></iframe>

    <script>
        // --- 1. LOCAL CONFIGURATION (Must be defined BEFORE the external script runs) ---
        // CURRENT_TAB_INDEX for dag0.html
        let CURRENT_TAB_INDEX = 0; 

        // --- 2. EMBEDDED CLOCK/SPLASH LOGIC (Only JavaScript functions remain here) ---
        const splash = document.getElementById('splash');
        const clock = document.getElementById('clock');
        const lastUpdate = document.getElementById('lastUpdate');
        const iframe = document.getElementById('sheetFrame');

        const refreshInterval = 30 * 60 * 1000; // 30 minutes
        const splashDuration = 1500; // 1.5 seconds

        function updateClock() {
            const now = new Date();
            clock.textContent =
                `${String(now.getHours()).padStart(2,'0')}:` +
                `${String(now.getMinutes()).padStart(2,'0')}:` +
                `${String(now.getSeconds()).padStart(2,'0')}`;
        }
        setInterval(updateClock, 1000);
        updateClock();

        // This function relies on buildTabs() which is in the external file
        function refreshSheet() {
            splash.classList.remove('hidden');
            
            // CRITICAL: We call buildTabs() here. Since lista_logic.js is deferred,
            // this function will now exist when it is called below.
            buildTabs(); 
            
            const now = new Date();
            lastUpdate.textContent =
                `Last update: ${String(now.getHours()).padStart(2,'0')}:${String(now.getMinutes()).padStart(2,'0')}`;
            
            setTimeout(() => splash.classList.add('hidden'), splashDuration);
        }
        
        setInterval(refreshSheet, refreshInterval);

        // CRITICAL INITIALIZATION: The defer attribute (below) ensures that by the time 
        // the browser reaches this point, the external script is fully loaded.
        // Therefore, calling refreshSheet() here is safe.
        refreshSheet(); 
        
    </script>
    
    <script src="lista_logic.js" defer></script>
</body>
</html>
